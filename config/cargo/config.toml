[target.x86_64-unknown-linux-gnu]
rustflags = ["-Clink-arg=-fuse-ld=mold"]


# Quick compilation times over everything.
[profile.dev]
codegen-backend = "cranelift"
lto = "off"

# Fast and shippable, with panics being useful but no other debuginfo.
[profile.release]
codegen-units = 1
lto = true
debug = "line-tables-only"


# Compromise between compilation times and performance.
# Thought for graphical applications.
[profile.gfx]
inherits = "dev"
# this is [5%, 20%] more compile time in my tests
# cranelift is just that fast that 
opt-level = 3

# Release with debuginfo.
[profile.huge]
inherits = "release"
debug = "full"
debug-assertions = true

# Small.
[profile.min]
inherits = "release"
opt-level = "z"
debug = "none"
panic = "abort"
strip = "symbols"
incremental = true


[registries.crates-io]
protocol = "sparse"

[http]
ssl-version = "tlsv1.3"

[net]
retry = 2

# https://doc.rust-lang.org/cargo/reference/unstable.html#gc
[cache.global-clean]
max-crate-age = "2 years"
max-index-age = "1 year"
max-git-db-age = "2 year"


# https://doc.rust-lang.org/cargo/reference/unstable.html
[unstable]
# periodically clean download cache
gc = true
# allow e.g. cranelift as backend
codegen-backend = true
# add new --breaking flag to `cargo update`
unstable-options = true
# allow using cargo as shebang interpreter
script = true
# use gitoxide instead of git2 for git deps
gitoxide = true
# only ever do shallow clones of git repos
git = true
